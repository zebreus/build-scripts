From 773ee368ce66539979d15989aa644c267d7b57bf Mon Sep 17 00:00:00 2001
From: ptitSeb <sebastien.chev@gmail.com>
Date: Wed, 31 May 2023 13:38:17 +0200
Subject: [PATCH 2/6] [WASIX] Add source changes

---
 lib/select.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/lib/select.c b/lib/select.c
index cae9beb6c..bcbae30ab 100644
--- a/lib/select.c
+++ b/lib/select.c
@@ -351,8 +351,10 @@ int Curl_poll(struct pollfd ufds[], unsigned int nfds, timediff_t timeout_ms)
         FD_SET(ufds[i].fd, &fds_read);
       if(ufds[i].events & (POLLWRNORM|POLLOUT))
         FD_SET(ufds[i].fd, &fds_write);
+#ifndef __wasi__
       if(ufds[i].events & (POLLRDBAND|POLLPRI))
         FD_SET(ufds[i].fd, &fds_err);
+#endif
     }
   }
 
@@ -387,12 +389,14 @@ int Curl_poll(struct pollfd ufds[], unsigned int nfds, timediff_t timeout_ms)
       if(ufds[i].events & POLLOUT)
         ufds[i].revents |= POLLOUT;
     }
+#ifndef __wasi__
     if(FD_ISSET(ufds[i].fd, &fds_err)) {
       if(ufds[i].events & POLLRDBAND)
         ufds[i].revents |= POLLRDBAND;
       if(ufds[i].events & POLLPRI)
         ufds[i].revents |= POLLPRI;
     }
+#endif
     if(ufds[i].revents)
       r++;
   }
-- 
2.48.1

